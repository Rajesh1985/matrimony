<!-- src/app/pages/user-page/user-page.component.html (UPDATED - Address in sections) -->

<div class="user-page-container">
  <!-- Error message -->
  <div class="error-container" *ngIf="error">
    <div class="alert alert-danger">
      <strong>Error:</strong> {{ error }}
    </div>
  </div>

  <!-- Main content -->
  <div class="page-content" *ngIf="!isLoading && currentProfile">
    <!-- Left Sidebar: User Information -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h2>My Profile</h2>
      </div>

      <!-- User Summary Card -->
      <div class="profile-card">
        <div class="profile-avatar">
          <!-- Display photo if available, otherwise show avatar -->
          <div *ngIf="profilePhotoUrl; else defaultAvatar" class="photo-container">
            <img [src]="profilePhotoUrl" alt="Profile photo" class="profile-photo-img">
          </div>
          <ng-template #defaultAvatar>
            <app-avatar 
              [name]="currentProfile.name" 
              size="xl">
            </app-avatar>
          </ng-template>
        </div>

        <div class="profile-summary">
          <h3 class="profile-name">{{ currentProfile.name }}</h3>
          <p class="profile-id">ID: {{ currentProfile.serial_number }}</p>
          
          <div class="profile-quick-stats">
            <div class="stat">
              <span class="stat-label">Age</span>
              <span class="stat-value">{{ currentProfile.age }} Yrs</span>
            </div>
            <div class="stat">
              <span class="stat-label">Height</span>
              <span class="stat-value">{{ currentProfile.height_cm }} cm</span>
            </div>
          </div>

          <div class="profile-quick-info">
            <p><strong>{{ currentProfile.occupation }}</strong></p>
            <p class="text-muted">{{ currentProfile.caste }}</p>
            <p class="text-muted">{{ currentProfile.city }}, {{ currentProfile.state }}</p>
          </div>

          <div class="profile-badges">
            <span class="badge badge-primary">{{ currentProfile.star }}</span>
            <span class="badge badge-secondary">{{ currentProfile.rasi }}</span>
          </div>

          <p class="profile-about">{{ currentProfile.about_me }}</p>
        </div>
      </div>

      <!-- Expandable Sections -->
      <div class="sections-container">
        
        <!-- Personal Details Section -->
        <div class="section">
          <div class="section-header" (click)="toggleSection('personal')">
            <h4>Personal Details</h4>
            <span class="toggle-icon" [class.open]="expandedSections.personal">‚ñº</span>
          </div>
          <div class="section-content" *ngIf="expandedSections.personal">
            <div class="detail-row">
              <span class="label">Height:</span>
              <span class="value">{{ currentProfile.height_cm }} cm</span>
            </div>
            <div class="detail-row">
              <span class="label">Physical Status:</span>
              <span class="value">{{ currentProfile.physical_status }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Complexion:</span>
              <span class="value">{{ currentProfile.complexion }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Marital Status:</span>
              <span class="value">{{ currentProfile.marital_status }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Hobbies:</span>
              <span class="value">{{ currentProfile.hobbies || 'N/A' }}</span>
            </div>
            <button class="btn btn-edit" (click)="openEditModal('personal')">Edit</button>
          </div>
        </div>

        <!-- Professional Section -->
        <div class="section">
          <div class="section-header" (click)="toggleSection('professional')">
            <h4>Professional</h4>
            <span class="toggle-icon" [class.open]="expandedSections.professional">‚ñº</span>
          </div>
          <div class="section-content" *ngIf="expandedSections.professional">
            <div class="detail-row">
              <span class="label">Education:</span>
              <span class="value">{{ currentProfile.education }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Occupation:</span>
              <span class="value">{{ currentProfile.occupation }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Company:</span>
              <span class="value">{{ currentProfile.company_name }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Income:</span>
              <span class="value">{{ currentProfile.annual_income }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Work Location:</span>
              <span class="value">{{ currentProfile.work_location }}</span>
            </div>
            <button class="btn btn-edit" (click)="openEditModal('professional')">Edit</button>
          </div>
        </div>

        <!-- Family Section -->
        <div class="section">
          <div class="section-header" (click)="toggleSection('family')">
            <h4>Family</h4>
            <span class="toggle-icon" [class.open]="expandedSections.family">‚ñº</span>
          </div>
          <div class="section-content" *ngIf="expandedSections.family">
            <div class="detail-row">
              <span class="label">Family Type:</span>
              <span class="value">{{ currentProfile.family_type }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Status:</span>
              <span class="value">{{ currentProfile.family_status }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Brothers:</span>
              <span class="value">{{ currentProfile.brothers }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Sisters:</span>
              <span class="value">{{ currentProfile.sisters }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Married Brothers:</span>
              <span class="value">{{ currentProfile.married_brothers }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Married Sisters:</span>
              <span class="value">{{ currentProfile.married_sisters }}</span>
            </div>
            <!-- Community Certificate Section -->
            <div class="detail-row certificate-section" *ngIf="currentProfile.community_file_id">
              <span class="label">Community Certificate:</span>
              <button class="btn btn-sm btn-primary" (click)="viewCommunityCertificate()">
                üìÑ View Certificate
              </button>
            </div>
            <div class="detail-row certificate-section" *ngIf="!currentProfile.community_file_id">
              <span class="label text-muted">Community Certificate: Not uploaded</span>
            </div>
            <button class="btn btn-edit" (click)="openEditModal('family')">Edit</button>
          </div>
        </div>

        <!-- Astrology Section -->
        <div class="section">
          <div class="section-header" (click)="toggleSection('astrology')">
            <h4>Astrology</h4>
            <span class="toggle-icon" [class.open]="expandedSections.astrology">‚ñº</span>
          </div>
          <div class="section-content" *ngIf="expandedSections.astrology">
            <div class="detail-row">
              <span class="label">Star:</span>
              <span class="value">{{ currentProfile.star }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Rasi:</span>
              <span class="value">{{ currentProfile.rasi }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Lagnam:</span>
              <span class="value">{{ currentProfile.lagnam }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Birth Place:</span>
              <span class="value">{{ currentProfile.birth_place }}</span>
            </div>
            <!-- Horoscope Section -->
            <div class="detail-row horoscope-section" *ngIf="currentProfile.astrology_file_id">
              <span class="label">Horoscope:</span>
              <button class="btn btn-sm btn-primary" (click)="viewHoroscope()">
                üìÑ View Horoscope
              </button>
            </div>
            <div class="detail-row horoscope-section" *ngIf="!currentProfile.astrology_file_id">
              <span class="label text-muted">Horoscope: Not uploaded</span>
            </div>
            <button class="btn btn-edit" (click)="openEditModal('astrology')">Edit</button>
          </div>
        </div>

        <!-- Address Section -->
        <div class="section">
          <div class="section-header" (click)="toggleSection('address')">
            <h4>Address</h4>
            <span class="toggle-icon" [class.open]="expandedSections.address">‚ñº</span>
          </div>
          <div class="section-content" *ngIf="expandedSections.address">
            <div class="detail-row">
              <span class="label">Address Line 1:</span>
              <span class="value">{{ currentProfile.address_line1 }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Address Line 2:</span>
              <span class="value">{{ currentProfile.address_line2 || 'N/A' }}</span>
            </div>
            <div class="detail-row">
              <span class="label">City:</span>
              <span class="value">{{ currentProfile.city }}</span>
            </div>
            <div class="detail-row">
              <span class="label">State:</span>
              <span class="value">{{ currentProfile.state }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Country:</span>
              <span class="value">{{ currentProfile.country }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Postal Code:</span>
              <span class="value">{{ currentProfile.postal_code }}</span>
            </div>
            <button class="btn btn-edit" (click)="openEditModal('address')">Edit</button>
          </div>
        </div>

        <!-- Preferences Section -->
        <div class="section">
          <div class="section-header" (click)="toggleSection('preferences')">
            <h4>Partner Preferences</h4>
            <span class="toggle-icon" [class.open]="expandedSections.preferences">‚ñº</span>
          </div>
          <div class="section-content" *ngIf="expandedSections.preferences">
            <div class="detail-row">
              <span class="label">Age Range:</span>
              <span class="value">{{ currentProfile.age_from }} - {{ currentProfile.age_to }} Yrs</span>
            </div>
            <div class="detail-row">
              <span class="label">Height Range:</span>
              <span class="value">{{ currentProfile.height_from }} - {{ currentProfile.height_to }} cm</span>
            </div>
            <button class="btn btn-edit" (click)="openEditModal('preferences')">Edit</button>
          </div>
        </div>

      </div>
    </aside>

    <!-- Right Section: Recommended Profiles -->
    <main class="main-content">
      <div class="main-header">
        <h2>Recommended Profiles</h2>
        <p class="text-muted" *ngIf="recommendedProfiles.length > 0">
          {{ recommendedProfiles.length }} Profile{{ recommendedProfiles.length !== 1 ? 's' : '' }} found
        </p>
      </div>

      <!-- Loading State -->
      <div class="loading-container" *ngIf="isLoadingRecommendations">
        <div class="spinner"></div>
        <p>Loading recommended profiles...</p>
      </div>

      <!-- No Profiles -->
      <div class="no-profiles" *ngIf="!isLoadingRecommendations && recommendedProfiles.length === 0">
        <p>No matching profiles found. Update your preferences to see recommendations.</p>
      </div>

      <!-- Profiles Grid -->
      <div class="profiles-grid" *ngIf="!isLoadingRecommendations && recommendedProfiles.length > 0">
        <div class="profile-card-item" *ngFor="let profile of recommendedProfiles">
          
          <!-- Profile Header with Photo & Quick Info -->
          <div class="profile-card-header">
            <div class="profile-photo">
              <!-- Display photo if available, otherwise show avatar -->
              <div *ngIf="recommendedProfilePhotos[profile.match_profile_id]; else defaultProfileAvatar" class="photo-container">
                <img [src]="recommendedProfilePhotos[profile.match_profile_id]" alt="Profile photo" class="profile-photo-img">
              </div>
              <ng-template #defaultProfileAvatar>
                <app-avatar 
                  [name]="profile.name" 
                  size="lg">
                </app-avatar>
              </ng-template>
            </div>

            <div class="profile-header-info">
              <div>
                <h3 class="profile-title">{{ profile.name }}</h3>
                <p class="profile-subtitle">ID: {{ profile.serial_number }}</p>
              </div>
              <div class="profile-meta">
                <span class="age-badge">{{ profile.age }} Yrs</span>
                <span class="height-badge">{{ profile.height_cm }} cm</span>
              </div>
            </div>

            <div class="match-score">
              <div class="score-circle" [class]="'score-' + profile.match_score">
                {{ profile.match_score }}/8
              </div>
              <small>Match</small>
            </div>
          </div>

          <!-- Profile Body -->
          <div class="profile-card-body">
            <div class="profile-detail">
              <strong>{{ profile.occupation }}</strong>
              <span class="text-muted">{{ profile.city }}, {{ profile.state }}</span>
            </div>

            <div class="profile-astro">
              <span class="text-muted">{{ profile.star }}</span>
              <span class="text-muted">{{ profile.rasi }}</span>
            </div>

            <p class="profile-about">{{ profile.about_me }}</p>
          </div>

          <!-- Profile Footer: Actions -->
          <div class="profile-card-footer">
            <button class="btn btn-primary btn-block" (click)="viewProfile(profile)">
              üëÅÔ∏è View Profile
            </button>
            <button class="btn btn-secondary" (click)="sendInterest(profile)">
              üíå Interest
            </button>
            <button class="btn btn-outline" (click)="addToFavorites(profile)">
              ‚ù§Ô∏è
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Loading State for Page -->
  <div class="loading-page" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Loading your profile...</p>
  </div>
</div>

<!-- Edit Modal -->
<div class="modal-overlay" *ngIf="showEditModal" (click)="closeEditModal()">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Edit {{ editingSection | uppercase }}</h3>
      <button class="modal-close" (click)="closeEditModal()">&times;</button>
    </div>

    <div class="modal-body">
      <!-- PERSONAL SECTION FORM -->
      <div *ngIf="editingSection === 'personal'" class="edit-form-section">
        <!-- Name -->
        <div class="form-group">
          <label for="name">Name</label>
          <input 
            type="text" 
            id="name" 
            class="form-control"
            [(ngModel)]="editFormData.name" 
            placeholder="Full Name">
        </div>

        <!-- Birth Date -->
        <div class="form-group">
          <label for="birth_date">Date of Birth</label>
          <input 
            type="date" 
            id="birth_date" 
            class="form-control"
            [(ngModel)]="editFormData.birth_date">
        </div>

        <!-- Birth Time -->
        <div class="form-group">
          <label for="birth_time">Time of Birth</label>
          <input 
            type="time" 
            id="birth_time" 
            class="form-control"
            [(ngModel)]="editFormData.birth_time">
        </div>

        <!-- Height -->
        <div class="form-group">
          <label for="height_cm">Height (cm)</label>
          <input 
            type="number" 
            id="height_cm" 
            class="form-control"
            [(ngModel)]="editFormData.height_cm" 
            placeholder="Height in centimeters">
        </div>

        <!-- Complexion -->
        <div class="form-group">
          <label for="complexion">Complexion</label>
          <select 
            id="complexion" 
            class="form-control"
            [(ngModel)]="editFormData.complexion">
            <option value="">Select Complexion</option>
            <option *ngFor="let opt of complexionOptions" [value]="opt.value">
              {{ opt.label }}
            </option>
          </select>
        </div>

        <!-- Mobile Number -->
        <div class="form-group">
          <label for="mobile_number">Mobile Number</label>
          <input 
            type="text" 
            id="mobile_number" 
            class="form-control"
            [(ngModel)]="editFormData.mobile_number" 
            placeholder="Mobile number">
        </div>

        <!-- Physical Status -->
        <div class="form-group">
          <label for="physical_status">Physical Status</label>
          <select 
            id="physical_status" 
            class="form-control"
            [(ngModel)]="editFormData.physical_status">
            <option value="">Select Physical Status</option>
            <option *ngFor="let opt of physicalStatusOptions" [value]="opt.value">
              {{ opt.label }}
            </option>
          </select>
        </div>

        <!-- Marital Status -->
        <div class="form-group">
          <label for="marital_status">Marital Status</label>
          <select 
            id="marital_status" 
            class="form-control"
            [(ngModel)]="editFormData.marital_status">
            <option value="">Select Marital Status</option>
            <option *ngFor="let opt of maritalStatusOptions" [value]="opt.value">
              {{ opt.label }}
            </option>
          </select>
        </div>

        <!-- Food Preference -->
        <div class="form-group">
          <label for="food_preference">Food Preference</label>
          <select 
            id="food_preference" 
            class="form-control"
            [(ngModel)]="editFormData.food_preference">
            <option value="">Select Food Preference</option>
            <option *ngFor="let opt of foodPreferenceOptions" [value]="opt.value">
              {{ opt.label }}
            </option>
          </select>
        </div>

        <!-- Hobbies -->
        <div class="form-group">
          <label for="hobbies">Hobbies</label>
          <textarea 
            id="hobbies" 
            class="form-control"
            [(ngModel)]="editFormData.hobbies" 
            placeholder="Your hobbies"
            rows="3"></textarea>
        </div>

        <!-- About Me -->
        <div class="form-group">
          <label for="about_me">About Me</label>
          <textarea 
            id="about_me" 
            class="form-control"
            [(ngModel)]="editFormData.about_me" 
            placeholder="Tell about yourself"
            rows="4"></textarea>
        </div>
      </div>

      <!-- OTHER SECTIONS (Placeholder for future sections) -->
      <div *ngIf="editingSection !== 'personal'" class="edit-form-section">
        <p>Edit form for {{ editingSection }} section</p>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeEditModal()">Cancel</button>
      <button class="btn btn-primary" (click)="saveSection()">Save Changes</button>
    </div>
  </div>
</div>

<!-- Community Certificate Modal -->
<div class="modal-overlay" *ngIf="showCertificateModal" (click)="closeCertificateModal()">
  <div class="modal certificate-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Community Certificate</h3>
      <button class="modal-close" (click)="closeCertificateModal()">&times;</button>
    </div>

    <div class="modal-body certificate-body">
      <!-- Loading State -->
      <div class="loading-state" *ngIf="certificateLoading">
        <div class="spinner"></div>
        <p>Loading certificate...</p>
      </div>

      <!-- Error State -->
      <div class="error-state" *ngIf="certificateError && !certificateLoading">
        <div class="alert alert-danger">
          <strong>Error:</strong> {{ certificateError }}
        </div>
      </div>

      <!-- Certificate Display -->
      <div class="certificate-display" *ngIf="certificateUrl && !certificateLoading && !certificateError">
        <div class="certificate-viewer">
          <!-- For PDF, show in iframe -->
          <iframe 
            [attr.src]="certificateUrl"
            class="certificate-iframe"
            frameborder="0">
          </iframe>
        </div>
        <p class="certificate-filename">{{ certificateFileName }}</p>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeCertificateModal()">Close</button>
      <button class="btn btn-primary" (click)="downloadCertificate()" *ngIf="certificateUrl && !certificateLoading">
        ‚¨áÔ∏è Download
      </button>
    </div>
  </div>
</div>

<!-- Horoscope Modal -->
<div class="modal-overlay" *ngIf="showHoroscopeModal" (click)="closeHoroscopeModal()">
  <div class="modal horoscope-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Horoscope</h3>
      <button class="modal-close" (click)="closeHoroscopeModal()">&times;</button>
    </div>

    <div class="modal-body horoscope-body">
      <!-- Loading State -->
      <div class="loading-state" *ngIf="horoscopeLoading">
        <div class="spinner"></div>
        <p>Loading horoscope...</p>
      </div>

      <!-- Error State -->
      <div class="error-state" *ngIf="horoscopeError && !horoscopeLoading">
        <div class="alert alert-danger">
          <strong>Error:</strong> {{ horoscopeError }}
        </div>
      </div>

      <!-- Horoscope Display -->
      <div class="horoscope-display" *ngIf="horoscopeUrl && !horoscopeLoading && !horoscopeError">
        <div class="horoscope-viewer">
          <!-- For PDF, show in iframe -->
          <iframe 
            [attr.src]="horoscopeUrl"
            class="horoscope-iframe"
            frameborder="0">
          </iframe>
        </div>
        <p class="horoscope-filename">{{ horoscopeFileName }}</p>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="closeHoroscopeModal()">Close</button>
      <button class="btn btn-primary" (click)="downloadHoroscope()" *ngIf="horoscopeUrl && !horoscopeLoading">
        ‚¨áÔ∏è Download
      </button>
    </div>
  </div>
</div>

<!-- Profile View Modal -->
<div class="modal-overlay" *ngIf="showProfileModal && selectedProfile" (click)="closeProfileModal()">
  <div class="modal profile-modal" (click)="$event.stopPropagation()">
    <div class="modal-close-btn" (click)="closeProfileModal()">&times;</div>

    <div class="profile-card">
      <!-- Photo Slider -->
      <div class="profile-avatar-slider">
        <div *ngIf="selectedProfilePhotos.length > 0; else noPhotosAvailable" class="photo-slider-container">
          <!-- Current Photo -->
          <div class="slider-photo">
            <img [src]="selectedProfilePhotos[selectedProfilePhotoIndex]" 
                 alt="Profile photo" 
                 class="profile-photo-img">
          </div>

          <!-- Navigation Arrows -->
          <button class="slider-arrow slider-prev" (click)="prevPhoto()" *ngIf="selectedProfilePhotos.length > 1">
            &#10094;
          </button>
          <button class="slider-arrow slider-next" (click)="nextPhoto()" *ngIf="selectedProfilePhotos.length > 1">
            &#10095;
          </button>

          <!-- Photo Indicators -->
          <div class="slider-indicators" *ngIf="selectedProfilePhotos.length > 1">
            <ng-container *ngFor="let idx of [0, 1]">
              <span *ngIf="idx < selectedProfilePhotos.length"
                    class="indicator"
                    [class.active]="idx === selectedProfilePhotoIndex">
              </span>
            </ng-container>
          </div>
        </div>
        
        <ng-template #noPhotosAvailable>
          <div class="photo-placeholder">
            <app-avatar 
              [name]="selectedProfile.name" 
              size="xl">
            </app-avatar>
          </div>
        </ng-template>
      </div>

      <!-- Profile Summary -->
      <div class="profile-summary">
        <h3 class="profile-name">{{ selectedProfile.name }}</h3>
        <p class="profile-id">ID: {{ selectedProfile.serial_number }}</p>
        
        <div class="profile-quick-stats">
          <div class="stat">
            <span class="stat-label">Age</span>
            <span class="stat-value">{{ selectedProfile.age }} Yrs</span>
          </div>
          <div class="stat">
            <span class="stat-label">Height</span>
            <span class="stat-value">{{ selectedProfile.height_cm }} cm</span>
          </div>
        </div>

        <div class="profile-quick-info">
          <p><strong>{{ selectedProfile.occupation }}</strong></p>
          <p class="text-muted">{{ selectedProfile.caste }}</p>
          <p class="text-muted">{{ selectedProfile.city }}, {{ selectedProfile.state }}</p>
        </div>

        <div class="profile-badges">
          <span class="badge badge-primary">{{ selectedProfile.star }}</span>
          <span class="badge badge-secondary">{{ selectedProfile.rasi }}</span>
        </div>

        <p class="profile-about">{{ selectedProfile.about_me }}</p>

        <!-- Expandable Sections in Modal -->
        <div class="modal-sections-container">
          
          <!-- Personal Details Section -->
          <div class="section">
            <div class="section-header" (click)="toggleModalSection('personal')">
              <h4>Personal Details</h4>
              <span class="toggle-icon" [class.open]="modalExpandedSections.personal">‚ñº</span>
            </div>
            <div class="section-content" *ngIf="modalExpandedSections.personal">
              <div class="detail-row">
                <span class="label">Height:</span>
                <span class="value">{{ selectedProfile.height_cm }} cm</span>
              </div>
              <div class="detail-row">
                <span class="label">Physical Status:</span>
                <span class="value">{{ selectedProfile.physical_status }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Complexion:</span>
                <span class="value">{{ selectedProfile.complexion }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Marital Status:</span>
                <span class="value">{{ selectedProfile.marital_status }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Hobbies:</span>
                <span class="value">{{ selectedProfile.hobbies || 'N/A' }}</span>
              </div>
            </div>
          </div>

          <!-- Professional Section -->
          <div class="section">
            <div class="section-header" (click)="toggleModalSection('professional')">
              <h4>Professional</h4>
              <span class="toggle-icon" [class.open]="modalExpandedSections.professional">‚ñº</span>
            </div>
            <div class="section-content" *ngIf="modalExpandedSections.professional">
              <div class="detail-row">
                <span class="label">Education:</span>
                <span class="value">{{ selectedProfile.education }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Occupation:</span>
                <span class="value">{{ selectedProfile.occupation }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Company:</span>
                <span class="value">{{ selectedProfile.company_name }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Income:</span>
                <span class="value">{{ selectedProfile.annual_income }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Work Location:</span>
                <span class="value">{{ selectedProfile.work_location }}</span>
              </div>
            </div>
          </div>

          <!-- Family Section -->
          <div class="section">
            <div class="section-header" (click)="toggleModalSection('family')">
              <h4>Family</h4>
              <span class="toggle-icon" [class.open]="modalExpandedSections.family">‚ñº</span>
            </div>
            <div class="section-content" *ngIf="modalExpandedSections.family">
              <div class="detail-row">
                <span class="label">Family Type:</span>
                <span class="value">{{ selectedProfile.family_type }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Status:</span>
                <span class="value">{{ selectedProfile.family_status }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Brothers:</span>
                <span class="value">{{ selectedProfile.brothers }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Sisters:</span>
                <span class="value">{{ selectedProfile.sisters }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Married Brothers:</span>
                <span class="value">{{ selectedProfile.married_brothers }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Married Sisters:</span>
                <span class="value">{{ selectedProfile.married_sisters }}</span>
              </div>
            </div>
          </div>

          <!-- Astrology Section -->
          <div class="section">
            <div class="section-header" (click)="toggleModalSection('astrology')">
              <h4>Astrology</h4>
              <span class="toggle-icon" [class.open]="modalExpandedSections.astrology">‚ñº</span>
            </div>
            <div class="section-content" *ngIf="modalExpandedSections.astrology">
              <div class="detail-row">
                <span class="label">Star:</span>
                <span class="value">{{ selectedProfile.star }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Rasi:</span>
                <span class="value">{{ selectedProfile.rasi }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Lagnam:</span>
                <span class="value">{{ selectedProfile.lagnam }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Birth Place:</span>
                <span class="value">{{ selectedProfile.birth_place }}</span>
              </div>
            </div>
          </div>

          <!-- Address Section -->
          <div class="section">
            <div class="section-header" (click)="toggleModalSection('address')">
              <h4>Address</h4>
              <span class="toggle-icon" [class.open]="modalExpandedSections.address">‚ñº</span>
            </div>
            <div class="section-content" *ngIf="modalExpandedSections.address">
              <div class="detail-row">
                <span class="label">Address Line 1:</span>
                <span class="value">{{ selectedProfile.address_line1 }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Address Line 2:</span>
                <span class="value">{{ selectedProfile.address_line2 || 'N/A' }}</span>
              </div>
              <div class="detail-row">
                <span class="label">City:</span>
                <span class="value">{{ selectedProfile.city }}</span>
              </div>
              <div class="detail-row">
                <span class="label">State:</span>
                <span class="value">{{ selectedProfile.state }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Country:</span>
                <span class="value">{{ selectedProfile.country }}</span>
              </div>
              <div class="detail-row">
                <span class="label">Postal Code:</span>
                <span class="value">{{ selectedProfile.postal_code }}</span>
              </div>
            </div>
          </div>

        </div>

        <!-- Action Buttons -->
        <div class="profile-actions">
          <button class="btn btn-primary btn-block" (click)="sendInterest(selectedProfile)">
            üíå Send Interest
          </button>
          <button class="btn btn-secondary btn-block" (click)="addToFavorites(selectedProfile)">
            ‚ù§Ô∏è Add to Favorites
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

